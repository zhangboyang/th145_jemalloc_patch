; full patch file
; this patch let th145.exe load patch.dll and call patch()
; by ZBY

<th145.exe
?f54bdd766533707cfbc82a1e9c86d24f // check input md5

:38cfb3/78dbb3 // hook start
E9 F2 B9 08

:/8195aa // call my shellcode
E8 F1 EF E3 FF E8 30 59 F8 FF E9 FF 45 F7 FF 00


:/6585a0 // hook antidebugger
EB 1A 90 6A

:/6585bc
55 64 A1 30 00 00 00 89 E5 57 56 53 83 EC 1C 8B
40 0C 8B 48 14 E9 E0 03 00 00

:/6589b6
8B 51 28 68 2E 64 6C 6C 68 65 6C 33 32 68 6B 65
72 6E 31 C0 31 DB 66 83 3A 00 74 13 8A 04 24 66
3B 02 74 07 2C 20 66 3B 02 75 02 FE C7 42 42 44
FE C3 80 FB 0C 75 DF 66 81 FB 0C 0C 74 04 8B 09
EB BE E9 DE 01 00

:/658bdb
8B 51 10 31 F6 C7 45 DC 00 00 00 00 8B 42 3C 8B
7C 02 78 01 D7 8B 47 20 01 D0 89 45 D8

8B 45 D8 8B 0C 70 01 D1 31 C0 31 DB 80 39 4C 74
18 68 73 73 00 00 68 64 64 72 65 68 72 6F 63 41
68 47 65 74 50 B4 10 EB 11 68 61 72 79 41 68 4C
69 62 72 68 4C 6F 61 64 B4 0C 80 39 00 74 0A 8A
04 24 3A 01 75 02 FE C7 41 44 FE C3 38 E3 75 EA
66 81 FB 0C 0C 74 0C 66 81 FB 10 0E 8D 45 F0 75
25 EB 03 8D 45 EC 89 45 E0 8D 04 32 03 47 24 FF
45 DC 0F B7 00 8D 04 82 03 47 1C 8B 08 01 D1 89
C8 8B 4D E0 89 01 83 C6 02 83 7D DC 01 0F 8E 6D
FF FF FF

8B 5D F0 8B 45 EC 6A 6C 68 68 2E 64 6C 68 70 61
74 63 54 FF D0 83 C4 0C 6A 68 68 70 61 74 63 54
50 FF D3 83 C4 08 FF D0 83 C4 1C 5B 5E 5F 5D C3

?303058e8d06af3f74a8e5d2cc9883595 // check output md5

>th145_full_patched.exe
